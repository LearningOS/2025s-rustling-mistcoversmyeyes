### ğŸ¤– Assistant

# Rust è¿­ä»£å™¨ç‹¬ç«‹æ‰‹å†Œï¼ˆCollection-Agnosticï¼‰
ç»“åˆä½ å®Œæˆçš„ Rustlings ç»ƒä¹ ï¼Œä»¥ä¸‹æ˜¯è¿­ä»£å™¨çš„æ ¸å¿ƒæ¦‚å¿µä¸æ–¹æ³•é€ŸæŸ¥ï¼ˆä¸ä¾èµ–å…·ä½“é›†åˆç±»å‹ï¼‰ï¼š
## ä¸€ã€åŸºç¡€æ¦‚å¿µå›¾è§£
```rust
// æ‰€æœ‰è¿­ä»£å™¨éƒ½å®ç° Iterator trait
pub trait Iterator {
    type Item;
    fn next(&mut self) -> Option<Self::Item>;
}
```
ï¼ˆå›¾ç¤ºï¼šè¿­ä»£å™¨çš„æƒ°æ€§æ±‚å€¼ç‰¹æ€§ï¼‰
## äºŒã€æ ¸å¿ƒæ–¹æ³•åˆ†ç±»ï¼ˆåŸºäºä¹ é¢˜ï¼‰
### 1. è½¬æ¢æ“ä½œï¼ˆiterators2/3/4ï¼‰
| æ–¹æ³•       | ä½œç”¨                      | ç¤ºä¾‹ä»£ç ï¼ˆæ¥è‡ªç»ƒä¹ ï¼‰                   | C++ è¿‘ä¼¼         |
|------------|---------------------------|----------------------------------------|------------------|
| `map`      | å…ƒç´ è½¬æ¢                  | `(1..5).map(|x| x*2)`                 | `std::transform` |
| `filter`   | æ¡ä»¶è¿‡æ»¤                  | `vec.iter().filter(|&x| x%2 == 0)`    | `std::copy_if`   |
| `flat_map` | å±•å¹³åµŒå¥—ç»“æ„              | `vecs.iter().flat_map(|v| v.iter())`  | åµŒå¥—å¾ªç¯          |
| `enumerate`| æ·»åŠ ç´¢å¼•                  | `["a","b"].iter().enumerate()`        | æ‰‹åŠ¨è®¡æ•°å˜é‡      |
### 2. æ¶ˆè´¹æ“ä½œï¼ˆiterators5ï¼‰
| æ–¹æ³•        | ä½œç”¨                      | ç¤ºä¾‹ä»£ç                         | å¯¹åº”ä¹ é¢˜        |
|-------------|---------------------------|---------------------------------|-----------------|
| `count`     | è®¡æ•°                      | `iter.filter(...).count()`      | iter5           |
| `collect`   | æ”¶é›†ä¸ºé›†åˆ                | `(1..5).collect::<Vec<_>>()`    | iter2/3         |
| `fold`      | ç´¯ç§¯è®¡ç®—                  | `(1..5).fold(0, |acc, x| acc+x)` | iter4 (é˜¶ä¹˜)    |
| `any/all`   | å­˜åœ¨æ€§/å…¨ç§°åˆ¤æ–­           | `iter.any(|x| x > 5)`           | -               |
### 3. ç»„åˆæ“ä½œï¼ˆiterators3ï¼‰
| æ–¹æ³•         | ä½œç”¨                      | ç¤ºä¾‹ä»£ç                           | é”™è¯¯å¤„ç†æ¡ˆä¾‹      |
|--------------|---------------------------|-----------------------------------|-------------------|
| `chain`      | è¿æ¥è¿­ä»£å™¨                | `iter1.chain(iter2)`             | -                 |
| `zip`        | å¹¶è¡Œè¿­ä»£                  | `keys.iter().zip(values.iter())` | -                 |
| `take_while` | æ¡ä»¶ç»ˆæ­¢                  | `iter.take_while(|&x| x < 5)`    | -                 |
## ä¸‰ã€æ€§èƒ½ç‰¹æ€§ï¼ˆåŸºäº vecs2 å¯¹æ¯”ï¼‰
### ä¸¤ç§è¿­ä»£æ¨¡å¼å¯¹æ¯”
```rust
// æ¨¡å¼ 1: å‘½ä»¤å¼ï¼ˆvecs2::vec_loopï¼‰
for x in &mut vec { *x *= 2 }  // åŸåœ°ä¿®æ”¹
// æ¨¡å¼ 2: å‡½æ•°å¼ï¼ˆvecs2::vec_mapï¼‰
vec.iter().map(|x| x*2).collect()  // ç”Ÿæˆæ–°é›†åˆ
```
| æŒ‡æ ‡        | å‘½ä»¤å¼              | å‡½æ•°å¼              | é€‚ç”¨åœºæ™¯             |
|-------------|---------------------|---------------------|---------------------|
| å†…å­˜ä½¿ç”¨    | ä½ï¼ˆåŸåœ°ä¿®æ”¹ï¼‰      | é«˜ï¼ˆæ–°å»ºé›†åˆï¼‰      | å¤§æ•°æ®é›†å¤„ç†        |
| å¹¶è¡Œæ½œåŠ›    | ä½                  | é«˜                  | å¤šæ ¸è®¡ç®—            |
| å¯ç»„åˆæ€§    | ä½                  | é«˜                  | å¤æ‚æ•°æ®æµæ°´çº¿      |
## å››ã€æ‰€æœ‰æƒä¸ç”Ÿå‘½å‘¨æœŸï¼ˆiterators5 ç¤ºä¾‹ï¼‰
### è¿­ä»£å™¨ç±»å‹çŸ©é˜µ
| ç±»å‹                | æ‰€æœ‰æƒçŠ¶æ€          | ç¤ºä¾‹                      | ä¿®æ”¹æƒé™          |
|---------------------|---------------------|---------------------------|-------------------|
| `iter()`            | ä¸å¯å˜å€Ÿç”¨          | `vec.iter()`              | åªè¯»              |
| `iter_mut()`        | å¯å˜å€Ÿç”¨            | `vec.iter_mut()`          | å¯ä¿®æ”¹å…ƒç´         |
| `into_iter()`       | è·å–æ‰€æœ‰æƒ          | `vec.into_iter()`         | æ¶ˆè´¹åŸé›†åˆ        |
### å…¸å‹ä½¿ç”¨æ¨¡å¼
```rust
// å®‰å…¨éå†ï¼ˆiterators1 æ¼”ç¤ºï¼‰
let mut iter = vec.iter();
while let Some(item) = iter.next() { /* ... */ }
// æ¶ˆè´¹å‹è¿­ä»£ï¼ˆiterators5 çš„ flat_mapï¼‰
collection.iter()
    .flat_map(|map| map.into_iter())  // è·å–HashMapæ‰€æœ‰æƒ
    .filter(...)
```
## äº”ã€å¸¸è§é”™è¯¯æ¨¡å¼ï¼ˆæ¥è‡ªä¹ é¢˜ï¼‰
### é”™è¯¯1ï¼šè¿­ä»£å™¨å¤±æ•ˆï¼ˆç±»ä¼¼C++é—®é¢˜ï¼‰
```rust
let mut vec = vec![1, 2, 3];
let first = vec.iter().next();
vec.push(4);  // ç¼–è¯‘é”™è¯¯ï¼å­˜åœ¨æ´»è·ƒå€Ÿç”¨
```
### é”™è¯¯2ï¼šè¯¯ç”¨è¿­ä»£å™¨çŠ¶æ€
```rust
let mut iter = vec.iter();
iter.next();
let sum: i32 = iter.sum();  // æ­£ç¡®ï¼ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹
```
### é”™è¯¯3ï¼šæ‰€æœ‰æƒè½¬ç§»
```rust
let vec = vec!["a".to_string()];
let s = vec.into_iter().next().unwrap();
// vec å·²è¢«æ¶ˆè´¹ï¼Œä¸å¯å†è®¿é—®
```
## å…­ã€å®ç”¨æ¨¡å¼é€ŸæŸ¥
### æ¨¡å¼1ï¼šResultå¤„ç†ï¼ˆiterators3ï¼‰
```rust
// æ”¶é›†Resultçš„è¿­ä»£å™¨
let results: Result<Vec<_>, _> = inputs.iter().map(|x| process(x)).collect();
```
### æ¨¡å¼2ï¼šå¹¶è¡Œå¤„ç†
```rust
use rayon::prelude::*;  // éœ€å¼•å…¥rayon
vec.par_iter().map(|x| heavy_compute(x)).collect()  // è‡ªåŠ¨å¹¶è¡ŒåŒ–
```
### æ¨¡å¼3ï¼šæƒ°æ€§æ— é™åºåˆ—ï¼ˆiterators4 é˜¶ä¹˜çš„è¿­ä»£å™¨å®ç°ï¼‰
```rust
(1..).filter(|x| x%2 == 0).take(5)  // æ— é™è¿­ä»£å™¨å–æœ‰é™ç»“æœ
```
## ä¸ƒã€ä¸C++/Pythonå¯¹æ¯”
| ç‰¹æ€§              | Rust                          | C++ (Range-v3)           | Python                   |
|-------------------|-------------------------------|--------------------------|--------------------------|
| æƒ°æ€§æ±‚å€¼          | é»˜è®¤                          | é»˜è®¤                     | ç”Ÿæˆå™¨è¡¨è¾¾å¼             |
| é“¾å¼è°ƒç”¨          | `iter().map().filter()`       | ` | transform | filter`  | `map(filter(...))`       |
| å†…å­˜å®‰å…¨          | ç¼–è¯‘æœŸä¿è¯                    | å¯èƒ½è¿­ä»£å™¨å¤±æ•ˆ           | è¿è¡Œæ—¶å¼‚å¸¸               |
| å¹¶è¡Œæ”¯æŒ          | rayon åº“æ— ç¼è¡”æ¥               | éœ€è¦æ‰‹åŠ¨çº¿ç¨‹ç®¡ç†         | multiprocessing å¤æ‚     |
## å®˜æ–¹å‚è€ƒ
- 
- [æ ‡å‡†åº“è¿­ä»£å™¨æ–¹æ³•ç´¢å¼•](https://doc.rust-lang.org/std/iter/#implementations)
å»ºè®®å°†æ­¤æ‰‹å†Œä¸é›†åˆé€ŸæŸ¥æ‰‹å†Œé…åˆä½¿ç”¨ï¼Œé€šè¿‡ `[1, 2, 3].iter()` çš„æ–¹å¼å¯å¿«é€Ÿåˆ›å»ºè¿­ä»£å™¨è¿›è¡Œé“¾å¼è°ƒç”¨ã€‚éœ€è¦æ·±å…¥æŸä¸ªæ–¹æ³•çš„å¤æ‚åº¦åˆ†æå—ï¼Ÿ